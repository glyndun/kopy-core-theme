var logs = [
[
400,
"POST",
"/v1/api/promotion_codes",
"SEP 27, 2021",
"12:11 PM"
],
[
400,
"POST",
"/v1/api/tokens",
"SEP 24, 2021",
"7:39 AM"
],
[
401,
"POST",
"/v1/api/checkout/sessions",
"JAN 3, 2022",
"1:54 AM"
],
[
200,
"GET",
"/v1/api/checkout/sessions",
"JAN 3, 2022",
"10:48 AM"
],
[
400,
"POST",
"/v1/api/checkout/sessions",
"FEB 8, 2022",
"11:15 PM"
],
[
403,
"GET",
"/v1/api/promotion_codes",
"JAN 3, 2022",
"12:56 PM"
],
[
500,
"GET",
"/v1/api/coupons",
"SEP 28, 2021",
"12:06 AM"
],
[
401,
"GET",
"/v1/api/promotion_codes",
"FEB 11, 2022",
"3:47 PM"
],
[
401,
"POST",
"/v1/api/tokens",
"FEB 8, 2022",
"2:24 PM"
],
[
400,
"GET",
"/v1/api/promotion_codes",
"DEC 16, 2021",
"3:58 PM"
],
[
400,
"POST",
"/v1/api/charges",
"SEP 24, 2021",
"8:10 PM"
],
[
200,
"GET",
"/v1/api/checkout/sessions",
"DEC 16, 2021",
"7:51 PM"
],
[
401,
"GET",
"/v1/api/coupons",
"JAN 7, 2022",
"10:52 PM"
],
[
403,
"POST",
"/v1/api/checkout/sessions",
"JAN 3, 2022",
"8:04 PM"
],
[
400,
"GET",
"/v1/api/tokens",
"JAN 3, 2022",
"3:23 AM"
],
[
500,
"GET",
"/v1/api/coupons",
"SEP 27, 2021",
"5:03 AM"
],
[
200,
"POST",
"/v1/api/coupons",
"SEP 27, 2021",
"7:55 AM"
],
[
200,
"GET",
"/v1/api/coupons",
"SEP 27, 2021",
"10:11 PM"
],
[
200,
"GET",
"/v1/api/charges",
"FEB 11, 2022",
"8:42 PM"
],
[
400,
"GET",
"/v1/api/tokens",
"SEP 25, 2021",
"12:01 AM"
],
[
401,
"POST",
"/v1/api/tokens",
"DEC 16, 2021",
"10:11 PM"
],
[
401,
"GET",
"/v1/api/prices",
"SEP 29, 2021",
"1:50 AM"
],
[
500,
"POST",
"/v1/api/charges",
"SEP 24, 2021",
"7:48 PM"
],
[
500,
"POST",
"/v1/api/promotion_codes",
"JAN 7, 2022",
"2:17 PM"
],
[
401,
"POST",
"/v1/api/coupons",
"SEP 29, 2021",
"3:51 AM"
],
[
200,
"GET",
"/v1/api/checkout/sessions",
"SEP 28, 2021",
"3:39 PM"
],
[
400,
"POST",
"/v1/api/coupons",
"JAN 7, 2022",
"2:45 AM"
],
[
200,
"GET",
"/v1/api/prices",
"JAN 3, 2022",
"6:12 AM"
],
[
400,
"GET",
"/v1/api/coupons",
"SEP 25, 2021",
"4:31 AM"
],
[
401,
"POST",
"/v1/api/promotion_codes",
"SEP 24, 2021",
"9:19 PM"
],
[
200,
"POST",
"/v1/api/prices",
"SEP 28, 2021",
"11:23 PM"
],
[
403,
"POST",
"/v1/api/promotion_codes",
"JAN 3, 2022",
"5:17 AM"
],
[
400,
"GET",
"/v1/api/tokens",
"SEP 27, 2021",
"5:25 AM"
],
[
401,
"GET",
"/v1/api/prices",
"DEC 16, 2021",
"6:58 AM"
],
[
401,
"GET",
"/v1/api/tokens",
"SEP 24, 2021",
"7:21 PM"
],
[
200,
"GET",
"/v1/api/promotion_codes",
"DEC 16, 2021",
"9:21 PM"
],
[
500,
"POST",
"/v1/api/prices",
"SEP 25, 2021",
"11:59 AM"
],
[
403,
"POST",
"/v1/api/tokens",
"SEP 24, 2021",
"8:53 AM"
],
[
400,
"GET",
"/v1/api/checkout/sessions",
"FEB 8, 2022",
"6:22 AM"
],
[
403,
"GET",
"/v1/api/charges",
"JAN 7, 2022",
"2:18 AM"
],
[
400,
"GET",
"/v1/api/checkout/sessions",
"JAN 7, 2022",
"10:49 AM"
],
[
400,
"POST",
"/v1/api/checkout/sessions",
"DEC 16, 2021",
"10:01 AM"
],
[
401,
"POST",
"/v1/api/checkout/sessions",
"SEP 24, 2021",
"8:57 PM"
],
[
403,
"POST",
"/v1/api/prices",
"SEP 29, 2021",
"2:44 AM"
],
[
401,
"POST",
"/v1/api/tokens",
"SEP 24, 2021",
"8:02 PM"
],
[
400,
"GET",
"/v1/api/charges",
"JAN 7, 2022",
"7:34 AM"
],
[
500,
"GET",
"/v1/api/checkout/sessions",
"DEC 16, 2021",
"7:35 PM"
],
[
200,
"POST",
"/v1/api/charges",
"SEP 29, 2021",
"6:13 AM"
],
[
500,
"GET",
"/v1/api/coupons",
"SEP 25, 2021",
"5:14 AM"
],
[
401,
"GET",
"/v1/api/tokens",
"FEB 8, 2022",
"3:01 AM"
],
[
401,
"GET",
"/v1/api/promotion_codes",
"SEP 24, 2021",
"2:09 PM"
],
[
403,
"GET",
"/v1/api/charges",
"SEP 24, 2021",
"11:53 PM"
],
[
500,
"GET",
"/v1/api/promotion_codes",
"JAN 3, 2022",
"8:27 PM"
],
[
200,
"POST",
"/v1/api/prices",
"SEP 25, 2021",
"12:17 AM"
],
[
403,
"GET",
"/v1/api/coupons",
"DEC 16, 2021",
"12:29 AM"
],
[
400,
"GET",
"/v1/api/charges",
"JAN 3, 2022",
"8:02 PM"
],
[
403,
"POST",
"/v1/api/charges",
"JAN 3, 2022",
"12:42 AM"
],
[
403,
"POST",
"/v1/api/prices",
"FEB 8, 2022",
"5:03 PM"
],
[
400,
"GET",
"/v1/api/promotion_codes",
"JAN 7, 2022",
"12:48 AM"
],
[
500,
"GET",
"/v1/api/checkout/sessions",
"FEB 11, 2022",
"11:41 PM"
],
[
400,
"GET",
"/v1/api/checkout/sessions",
"SEP 29, 2021",
"2:55 AM"
],
[
400,
"GET",
"/v1/api/prices",
"JAN 3, 2022",
"2:13 AM"
],
[
400,
"GET",
"/v1/api/prices",
"SEP 28, 2021",
"2:18 PM"
],
[
401,
"GET",
"/v1/api/prices",
"SEP 29, 2021",
"7:42 PM"
]
], status = 'all';

$.fn.dataTable.ext.search.push(function(settings, searchData, index, rowData){
	if (status === 'all') return true;

    if (status === 'success') {
        return rowData[0] === 200;
    }

    return rowData[0] > 200;
});

var groupColumn = 3;
var table = $('#subscription_logs_table').DataTable({
    data: logs,
    "dom": '<"top">rt<"bottom"il><"clear">',
    "columnDefs": [
        { "visible": false, "targets": groupColumn },
        { "className": "ps-4 w-10r", "targets": 0 },
        { "className": "text-dark text-opacity-75 w-10r", "targets": 1 },
        { "className": "text-dark text-opacity-75", "targets": 2 },
        { "className": "pe-4 text-end text-dark text-opacity-75", "targets": -1 }
    ],
    "order": [[ groupColumn, 'asc' ]],
    "displayLength": 8,
    "drawCallback": function ( settings ) {
        var api = this.api();
        var rows = api.rows( {page:'current'} ).nodes();
        var last=null;

        api.column(groupColumn, {page:'current'} ).data().each( function ( group, i ) {
            if ( last !== group ) {
                $(rows).eq( i ).before(
                    '<tr class="group fw-bold"><td colspan="5" class="ps-4 text-dark text-opacity-75">'+group+'</td></tr>'
                );

                last = group;
            }
        } );
    },
    "fnCreatedRow": function( nRow, aData, iDataIndex ) {
        var status = aData[0] <= 200 ? 'success' : 'danger';
        var title = aData[0] <= 200 ? 'OK' : 'ERR';
        var html = '<span class="badge bg-light-'+status+' text-'+status+' fw-normal">'+aData[0]+' '+ title +'</span>';
        $('td:eq(0)', nRow).html(html);
    },
} );
